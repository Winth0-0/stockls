import{a as J,b as U,c as ie}from"./chunk-233UN773.js";import{a as V,e as Y}from"./chunk-SJ62V47W.js";import{a as ne}from"./chunk-UAU5ASY2.js";import{t as z}from"./chunk-WM2E7EKX.js";import{d as A,g as I,l as k,n as q,w as T}from"./chunk-7TKS4KVV.js";import{d as R}from"./chunk-LHRQNHW5.js";import"./chunk-J73STOSX.js";import"./chunk-RWF2ZYCY.js";import{Cc as o,Db as P,Dc as x,Ec as p,Fd as Q,Hc as E,Ic as f,Jb as b,Jc as h,Ld as D,Sb as _,Uc as W,Wc as L,Yc as X,cc as t,dc as e,ec as S,ic as w,mc as y,ob as l,oc as B,sc as N,tc as G,ub as C,vc as O,vd as M,wc as j,xa as c,xc as H,ya as s}from"./chunk-WLVN7P5V.js";import{e as F,f as v}from"./chunk-EQDQRRRY.js";var K=F(ie());var me=["secondDialog"];function ue(m,g){if(m&1){let n=w();t(0,"tr")(1,"th",21),o(2),e(),t(3,"td"),o(4),e(),t(5,"td"),o(6),W(7,"date"),e(),t(8,"td"),o(9),W(10,"date"),e(),t(11,"td"),o(12),e(),t(13,"td")(14,"button",22),y("click",function(){let i=c(n).$implicit,u=B();return s(u.pop(i.id))}),o(15,"\u0E23\u0E32\u0E22\u0E25\u0E30\u0E40\u0E2D\u0E35\u0E22\u0E14"),e()(),S(16,"td"),e()}if(m&2){let n=g.$implicit;l(2),x(n.id),l(2),p(" ",n.name," "),l(2),p(" ",L(7,5,n.active,"dd/MM/yyyy(HH:mm)")," "),l(3),p(" ",L(10,8,n.expired,"dd/MM/yyyy(HH:mm)")," "),l(3),p(" ",n.totalprice," ")}}function de(m,g){if(m&1&&(t(0,"tr")(1,"th",21),o(2),e(),t(3,"td"),o(4),e(),t(5,"td"),o(6),e(),t(7,"td"),o(8),e()()),m&2){let n=g.$implicit,r=g.index;l(2),x(r+1),l(2),p(" ",n.goodname," "),l(2),p(" ",n.amou," "),l(2),p(" ",n.stock," ")}}function ce(m,g){if(m&1){let n=w();t(0,"div",23)(1,"h4",24),o(2,"\u0E42\u0E1B\u0E23\u0E42\u0E21\u0E0A\u0E31\u0E48\u0E19"),e()(),t(3,"div",25)(4,"div",26)(5,"div",27)(6,"h4"),o(7),e(),t(8,"p",28),o(9,"\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32\u0E43\u0E19\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E42\u0E1B\u0E23\u0E42\u0E21\u0E0A\u0E31\u0E48\u0E19\u0E19\u0E35\u0E49 "),e()(),t(10,"div",29)(11,"table",18)(12,"thead")(13,"tr")(14,"th",19),o(15,"#"),e(),t(16,"th",19),o(17,"\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32"),e(),t(18,"th",19),o(19,"\u0E08\u0E33\u0E19\u0E27\u0E19\u0E43\u0E19\u0E42\u0E1B\u0E23\u0E42\u0E21\u0E0A\u0E31\u0E48\u0E19"),e(),t(20,"th",19),o(21,"Total StockOnHand0"),e()()(),t(22,"tbody"),b(23,de,9,4,"tr",20),e()()()()(),t(24,"div",30)(25,"button",31),y("click",function(){let i=c(n).close;return s(i("Close click"))}),o(26,"\u0E1B\u0E34\u0E14"),e()()}if(m&2){let n=B();l(7),p("\u0E42\u0E1B\u0E23\u0E42\u0E21\u0E0A\u0E31\u0E48\u0E19 : ",n.promotionlist[0].name,""),l(16),_("ngForOf",n.promotionlist)}}var Z=(()=>{class m{constructor(n,r){this.service=n,this.modalService=r,this.from="",this.to="",this.promotioninfo=[],this.promotionlist=[]}ngOnInit(){return v(this,null,function*(){try{this.promotioninfo=yield this.service.GetPromotionNow()}catch(n){console.error("API failed:",n),alert("API failed")}})}Search(){return v(this,null,function*(){try{this.promotioninfo=yield this.service.GetPromotion(this.from,this.to)}catch(n){console.error("API failed:",n),alert("API failed")}})}exportToExcel(){let r={Sheets:{"Promotion List":U.json_to_sheet(this.promotioninfo.map((a,d)=>({No:d+1,"Promotion Name":a.name,Active:new Date(a.active).toLocaleString(),Expire:new Date(a.expired).toLocaleString(),"Total Price":a.totalprice})))},SheetNames:["Promotion List"]},i=J(r,{bookType:"xlsx",type:"array"}),u=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});K.saveAs(u,`promotion-info_${new Date().toISOString().slice(0,10)}.xlsx`)}formatDateTime(n){let r=new Date(n),i=String(r.getDate()).padStart(2,"0"),u=String(r.getMonth()+1).padStart(2,"0"),a=r.getFullYear(),d=String(r.getHours()).padStart(2,"0"),te=String(r.getMinutes()).padStart(2,"0");return`${i}/${u}/${a}(${d}:${te})`}pop(n){return v(this,null,function*(){try{this.promotionlist=[],this.promotionlist=yield this.service.GetPromotionList(n)}catch(r){console.error("API failed:",r),alert("API failed")}this.modalService.open(this.secondDialog,{ariaLabelledBy:"modal-basic-title",size:"lg"})})}static{this.\u0275fac=function(r){return new(r||m)(C(V),C(z))}}static{this.\u0275cmp=P({type:m,selectors:[["app-private-chat"]],viewQuery:function(r,i){if(r&1&&O(me,7),r&2){let u;j(u=H())&&(i.secondDialog=u.first)}},decls:48,vars:3,consts:[["secondDialog",""],[1,"container-fluid","mt-5"],[1,"row"],[1,"col-xl-12","box-col-12"],[1,"card","height-equal"],[1,"card-header","total-revenue","card-no-border"],[1,"d-flex","align-items-center","gap-2"],[3,"click"],[1,"list-product-header","ml-2","mr-2",2,"margin-left","20px","margin-right","20px"],[1,"card","card-body","list-product-body"],[1,"row","row-cols-xl-5","row-cols-lg-4","row-cols-md-3","row-cols-sm-2","row-cols-2","g-3"],[1,"col"],[1,"form-label"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-label",2,"color","white"],[1,"form-control","btn","btn-primary","btn-block",3,"click"],[1,"card-body","pt-0"],[1,"table-order","table-responsive","custom-scrollbar"],[1,"table","table-striped","data-striped"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],[1,"modal-body"],[1,"card"],[1,"card-header"],[1,"mt-1","f-m-light"],[1,"card-body"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-dark","font-fam",3,"click"]],template:function(r,i){if(r&1){let u=w();t(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h4"),o(6,"Promotion List"),e(),t(7,"div",6)(8,"a",7),y("click",function(){return c(u),s(i.exportToExcel())}),o(9,"\u{1F4E4} \u0E14\u0E32\u0E27\u0E19\u0E4C\u0E42\u0E2B\u0E25\u0E14 Excel"),e()()(),t(10,"div",8)(11,"div")(12,"div",9)(13,"div",10)(14,"div",11)(15,"label",12),o(16,"\u0E40\u0E23\u0E34\u0E48\u0E21\u0E15\u0E49\u0E19"),e(),t(17,"input",13),h("ngModelChange",function(d){return c(u),f(i.from,d)||(i.from=d),s(d)}),e()(),t(18,"div",11)(19,"label",12),o(20,"\u0E2A\u0E34\u0E49\u0E19\u0E2A\u0E38\u0E14"),e(),t(21,"input",13),h("ngModelChange",function(d){return c(u),f(i.to,d)||(i.to=d),s(d)}),e()(),t(22,"div",11)(23,"label",14),o(24,"."),e(),t(25,"button",15),y("click",function(){return c(u),s(i.Search())}),o(26,"\u0E04\u0E49\u0E19\u0E2B\u0E32"),e()()()()()(),t(27,"div",16)(28,"div",17)(29,"table",18)(30,"thead")(31,"tr")(32,"th",19),o(33,"#"),e(),t(34,"th",19),o(35,"Promotion Name"),e(),t(36,"th",19),o(37,"Active"),e(),t(38,"th",19),o(39,"Expire"),e(),t(40,"th",19),o(41,"TotalPrice"),e(),t(42,"th",19),o(43,"Action"),e()()(),t(44,"tbody"),b(45,ue,17,11,"tr",20),e()()()()()()()(),b(46,ce,27,2,"ng-template",null,0,X)}r&2&&(l(17),E("ngModel",i.from),l(4),E("ngModel",i.to),l(24),_("ngForOf",i.promotioninfo))},dependencies:[D,M,Q,T,A,I,k],styles:["a[_ngcontent-%COMP%]{cursor:pointer}"]})}}return m})();var $=F(ne());function se(m,g){if(m&1){let n=w();t(0,"tr")(1,"td")(2,"a",25),o(3),e()(),t(4,"input",26),h("ngModelChange",function(i){let u=c(n).$implicit;return f(u.amou,i)||(u.amou=i),s(i)}),e()()}if(m&2){let n=g.$implicit;l(3),x(n.goodname),l(),N("name","amou_",n.id,""),E("ngModel",n.amou)}}var ee=(()=>{class m{constructor(n,r){this.service=n,this.router=r,this.stockinfo=[],this.user=null,this.formData={name:"",active:"",expire:"",totalprice:0,list:[]}}ngOnInit(){return v(this,null,function*(){this.user=JSON.parse(localStorage.getItem("user")||"null");try{this.stockinfo=yield this.service.GetStockInfo()}catch(n){console.error("API failed:",n),alert("API failed")}})}onSave(){return v(this,null,function*(){if(this.formData.name==""||this.formData.active==""||this.formData.expire==""||this.formData.totalprice==0)alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E04\u0E25\u0E31\u0E07\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32");else{let n={name:this.formData.name,active:this.formData.active,expire:this.formData.expire,totalprice:this.formData.totalprice,usrid:this.user?.usrcode,list:this.stockinfo.filter(i=>i.amou&&i.amou>0).map(i=>({goodid:i.id,amou:i.amou}))},r=new Y(n.name,n.active,n.expire,n.totalprice,n.list);try{yield this.service.SetPromotion(r),$.default.fire({title:"Success",icon:"success",draggable:!0}),this.formData={name:"",active:"",expire:"",totalprice:0,list:[]},this.ngOnInit()}catch(i){console.error("API failed:",i),alert("API failed")}}})}static{this.\u0275fac=function(r){return new(r||m)(C(V),C(R))}}static{this.\u0275cmp=P({type:m,selectors:[["app-group-chat"]],decls:53,vars:10,consts:[[1,"container-fluid","mt-5"],[1,"edit-profile"],[1,"row"],[1,"col-xl-4"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"card-options"],["href","javascript:void(0)",1,"card-options-collapse"],[1,"fe","fe-chevron-up"],["href","javascript:void(0)",1,"card-options-remove"],[1,"fe","fe-x"],[1,"card-body"],[1,"mb-3"],[1,"form-label"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],["type","number",1,"form-control",3,"ngModelChange","ngModel"],["type","text",1,"form-control",3,"placeholder","disabled"],[1,"form-footer"],[1,"btn","btn-primary","btn-block",3,"click","disabled"],[1,"col-xl-8"],[1,"table-responsive","add-project","custom-scrollbar"],[1,"table","card-table","table-vcenter","text-nowrap"],[4,"ngFor","ngForOf"],[1,"text-inherit"],["type","number",1,"form-control",3,"ngModelChange","ngModel","name"]],template:function(r,i){r&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),o(7,"Create Promotion"),e(),t(8,"div",7)(9,"a",8),S(10,"i",9),e(),t(11,"a",10),S(12,"i",11),e()()(),t(13,"div",12)(14,"div",13)(15,"label",14),o(16,"\u0E0A\u0E37\u0E48\u0E2D\u0E42\u0E1B\u0E23\u0E42\u0E21\u0E0A\u0E31\u0E48\u0E19"),e(),t(17,"input",15),h("ngModelChange",function(a){return f(i.formData.name,a)||(i.formData.name=a),a}),e()(),t(18,"div",13)(19,"label",14),o(20,"\u0E40\u0E23\u0E34\u0E48\u0E21\u0E15\u0E49\u0E19"),e(),t(21,"input",16),h("ngModelChange",function(a){return f(i.formData.active,a)||(i.formData.active=a),a}),e()(),t(22,"div",13)(23,"label",14),o(24,"\u0E2A\u0E34\u0E49\u0E19\u0E2A\u0E38\u0E14"),e(),t(25,"input",16),h("ngModelChange",function(a){return f(i.formData.expire,a)||(i.formData.expire=a),a}),e()(),t(26,"div",13)(27,"label",14),o(28,"\u0E23\u0E32\u0E04\u0E32"),e(),t(29,"input",17),h("ngModelChange",function(a){return f(i.formData.totalprice,a)||(i.formData.totalprice=a),a}),e()(),t(30,"div",13)(31,"label",14),o(32,"\u0E2A\u0E23\u0E49\u0E32\u0E07\u0E42\u0E14\u0E22"),e(),S(33,"input",18),e(),t(34,"div",19)(35,"button",20),y("click",function(){return i.onSave()}),o(36,"Save"),e()()()()(),t(37,"div",21)(38,"div",4)(39,"div",5)(40,"h4",6),o(41,"\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32\u0E40\u0E02\u0E49\u0E32\u0E23\u0E48\u0E27\u0E21\u0E42\u0E1B\u0E23\u0E42\u0E21\u0E0A\u0E31\u0E48\u0E19"),e()(),t(42,"div",22)(43,"table",23)(44,"thead")(45,"tr")(46,"th"),o(47,"Product Name"),e(),t(48,"th"),o(49,"\u0E08\u0E33\u0E19\u0E27\u0E19"),e(),S(50,"th"),e()(),t(51,"tbody"),b(52,se,5,4,"tr",24),e()()()()()()()()),r&2&&(l(17),E("ngModel",i.formData.name),l(4),E("ngModel",i.formData.active),l(4),E("ngModel",i.formData.expire),l(4),E("ngModel",i.formData.totalprice),l(4),G("placeholder","",i.user==null?null:i.user.fristname," ",i.user==null?null:i.user.lastname,""),_("disabled",!0),l(2),_("disabled",(i.user==null?null:i.user.row)!="admin"),l(17),_("ngForOf",i.stockinfo))},dependencies:[D,M,T,A,q,I,k],encapsulation:2})}}return m})();var Me=[{path:"",children:[{path:"private-chat",component:Z,data:{title:"Promotion List",breadcrumb:"Promotion List"}},{path:"group-chat",component:ee,data:{title:"Create Promotion",breadcrumb:"Create Promotion"}}]}];export{Me as Chat};
